\section{Algoritmo}\label{Algorithm}

\subsubsection{Pseudoc√≥digo}


\begin{alg}
	Suffix Automaton - let $\delta$ be the transition function of (Q, i, T, E)
	\begin{algorithmic}[1]
		
		\Function{sa}{$x$}
			\State $(Q, E) \leftarrow (\varnothing, \varnothing)$
			\State $i \leftarrow$ State-Creation
			\State $Length[i] \leftarrow 0$
			\State $F[i] \leftarrow$ NIL
			\State $last \leftarrow i$
			
			\For{$\ell$ from 1 up to $|x|$}
				\State  sa\_extend($\ell$)
			\EndFor
			
			\State $T \leftarrow \varnothing$
			\State $p \leftarrow last$
			
			\While{$p \neq$ NIL}
				\State $T \leftarrow T + \{p\}$
				\State $p \leftarrow F[p]$
			\EndWhile
			
			\Return (( Q, i, T, E ), Length, F)		
		\EndFunction
		
	\end{algorithmic}
\end{alg}


\begin{alg}
	Suffix Automaton Extend
	\begin{algorithmic}[1]
		
		\Function{sa\_extend}{$\ell$}
			\State $sa[i] \leftarrow x_\ell$
			\State $newlast \leftarrow$ State-Creation
			\State $Length[newlast] \leftarrow Length[last]+1$
			\State $p \leftarrow last$

			\While{$p \neq$ NIL and $\delta(p, a)$ $=$ NIL}
				\State  $E \leftarrow E + \{(p, a, newlast)\}$
				\State  $p \leftarrow F[p]$
			\EndWhile

			\If{$p = $ NIL}
				\State $F[newlast] \leftarrow i$
			
			\Else
				\State $q \leftarrow \delta(p, a)$
				
				\If{$Length[q] = Length[p]+1$}
					\State $F[newlast] \leftarrow q$
				
				\Else
					\State $q' \leftarrow$ State-Creation
					\For{each letter $b$ such that $\delta(q, b) \neq$ NIL}
						\State  $E \leftarrow E + \{(q', b, \delta(q, b))\}$
					\EndFor
					\State $Length[q'] \leftarrow Length[p]+1$
					\State $F[newlast] \leftarrow q'$
					\State $F[q'] \leftarrow F[q]$
					\State $F[q] \leftarrow q'$
					\While{$p \neq$ NIL and $\delta(p, a) = q$}
						\State  $E \leftarrow E - \{(p, a, q)\} + \{(p, a, q')\}$
						\State  $p \leftarrow F[p]$
					\EndWhile
				\EndIf

			\EndIf
			
			\State last $\leftarrow$ newlast
				
		\EndFunction
				
	\end{algorithmic}
\end{alg}

\cite{book:Crochemore1997}